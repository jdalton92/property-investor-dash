{"ast":null,"code":"import _regeneratorRuntime from\"/home/james/development/property-investor-dash/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/james/development/property-investor-dash/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/james/development/property-investor-dash/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/james/development/property-investor-dash/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{connect}from\"react-redux\";import{useHistory}from\"react-router-dom\";import{Form,Field}from\"react-final-form\";import{setModal}from\"../../reducers/navigationReducer\";import{saveDashboard,updateDashboard}from\"../../reducers/dashboardReducer\";import{setNotification}from\"../../reducers/notificationReducer\";import{composeValidators,required,maxLength,minLength}from\"../../utils/formValidatorHelper\";import{CONSTANTS}from\"../../static/constants\";import Button from\"../Shared/Button\";import{Icon}from\"../Shared/Icon\";import CloseIcon from\"../../styles/svg/close.svg\";import SaveIcon from\"../../styles/svg/save.svg\";import OverwriteIcon from\"../../styles/svg/overwrite.svg\";var SaveDashboardModal=function SaveDashboardModal(_ref){var isFetching=_ref.isFetching,currentDashboard=_ref.currentDashboard,savedDashboards=_ref.savedDashboards,user=_ref.user,setModal=_ref.setModal,setNotification=_ref.setNotification,saveDashboard=_ref.saveDashboard,updateDashboard=_ref.updateDashboard;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),saveNew=_useState2[0],setSaveNew=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),overwrite=_useState4[0],setOverwrite=_useState4[1];var history=useHistory();var handleSave=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(saveData){var dashObject;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(user.data.username){_context.next=4;break;}setModal(CONSTANTS.MODALS.SAVEDASHBOARD,false);setNotification(\"Please login to save dashboard\",\"danger\");return _context.abrupt(\"return\");case 4:dashObject=_objectSpread({values:currentDashboard},saveData);_context.next=7;return saveDashboard(dashObject);case 7:setModal(CONSTANTS.MODALS.SAVEDASHBOARD,false);if(!isFetching){setNotification(\"\".concat(saveData.description,\" saved\"),\"success\");history.push(\"/saved-dashboards\");}case 9:case\"end\":return _context.stop();}}},_callee);}));return function handleSave(_x){return _ref2.apply(this,arguments);};}();var handleOverwrite=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(saveData){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// await updateDashboard(saveData);\nconsole.log(\"overwrite \",overwrite);case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function handleOverwrite(_x2){return _ref3.apply(this,arguments);};}();var handleCancel=function handleCancel(e){// React Final Form handles preventDefault()\nsetModal(CONSTANTS.MODALS.SAVEDASHBOARD,false);};return/*#__PURE__*/React.createElement(\"div\",{className:\"modal mt60 fixed r bs-3 bg-1 p20\"},/*#__PURE__*/React.createElement(Button,{ariaLabel:\"Close\",dataBalloonPos:\"left\",extraClass:\"modal-close-btn mt20 mr20 button-p align-c justify-c\",onClick:handleCancel,iconUrl:CloseIcon,iconColor:\"white\"}),/*#__PURE__*/React.createElement(\"h2\",{className:\"f20 bold mb16\"},\"Save Dashboard\"),/*#__PURE__*/React.createElement(\"div\",{className:\"flex-row\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"save-opt button-transp-s rt pl16 pr16 flex-row align-c justify-c jump \".concat(saveNew?\"active\":\"\"),onClick:function onClick(){return setSaveNew(true);}},/*#__PURE__*/React.createElement(Icon,{size:\"20px\",url:SaveIcon,color:\"black\",hover:false,active:false}),/*#__PURE__*/React.createElement(\"span\",{className:\"ml8 f16 bold\"},\"Save New\")),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"save-opt button-transp-s rt pl16 pr16 flex-row align-c justify-c jump \".concat(saveNew?\"\":\"active\"),onClick:function onClick(){return setSaveNew(false);}},/*#__PURE__*/React.createElement(Icon,{size:\"20px\",url:OverwriteIcon,color:\"black\",hover:false,active:false}),/*#__PURE__*/React.createElement(\"span\",{className:\"ml8 f16 bold\"},\"Overwrite Existing\"))),saveNew&&/*#__PURE__*/React.createElement(Form,{onSubmit:handleSave,render:function render(_ref4){var handleSubmit=_ref4.handleSubmit,form=_ref4.form;return/*#__PURE__*/React.createElement(\"form\",{className:\"save-form mt20 mb20\",onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"flex-row align-c relative\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"save-description\",className:\"f16 mb8\"},\"Description\",/*#__PURE__*/React.createElement(\"span\",{className:\"font-red f12 bold ml4\"},\"*\"))),/*#__PURE__*/React.createElement(Field,{name:\"description\",validate:composeValidators(required,minLength(3),maxLength(200))},function(_ref5){var input=_ref5.input,meta=_ref5.meta;return/*#__PURE__*/React.createElement(\"div\",{className:\"relative mb20\"},/*#__PURE__*/React.createElement(\"input\",Object.assign({id:\"save-description\",className:\"form-input bs-1 w100\",placeholder:\"Description\",type:\"text\"},input)),meta.error&&meta.touched&&/*#__PURE__*/React.createElement(\"span\",{className:\"form-error f10\"},meta.error));}),/*#__PURE__*/React.createElement(\"div\",{className:\"flex-row align-c relative\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"save-description\",className:\"f16 mb8\"},\"Address\",/*#__PURE__*/React.createElement(\"span\",{className:\"font-red f12 bold ml4\"},\"*\"))),/*#__PURE__*/React.createElement(Field,{name:\"address\",validate:composeValidators(required,minLength(3),maxLength(200))},function(_ref6){var input=_ref6.input,meta=_ref6.meta;return/*#__PURE__*/React.createElement(\"div\",{className:\"relative mb20\"},/*#__PURE__*/React.createElement(\"input\",Object.assign({id:\"save-address\",className:\"form-input bs-1 w100\",placeholder:\"Address\",type:\"text\"},input)),meta.error&&meta.touched&&/*#__PURE__*/React.createElement(\"span\",{className:\"form-error f10\"},meta.error));}),/*#__PURE__*/React.createElement(\"div\",{className:\"form-buttons\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"form-button-p bs-3 font-white mt12 pt8 pb8\"},\"Save As\")));}}),!saveNew&&/*#__PURE__*/React.createElement(Form,{onSubmit:handleOverwrite,render:function render(_ref7){var handleSubmit=_ref7.handleSubmit,form=_ref7.form,values=_ref7.values;return/*#__PURE__*/React.createElement(\"form\",{className:\"save-form mt20 mb20\",onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"flex-row align-c relative\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"save-overwrite\",className:\"f16 mb8\"},\"Dashboard\",/*#__PURE__*/React.createElement(\"span\",{className:\"font-red f12 bold ml4\"},\"*\"))),/*#__PURE__*/React.createElement(Field,{name:\"dashboard\",validate:required},function(_ref8){var input=_ref8.input,meta=_ref8.meta;return/*#__PURE__*/React.createElement(\"div\",{className:\"relative mb20\"},/*#__PURE__*/React.createElement(\"select\",{className:\"form-input select w100 bs-1\",id:\"save-overwrite\",name:\"dashboard\",onChange:function onChange(){return setOverwrite(values);},multiple:true},savedDashboards.map(function(d,i){var _d$values;var type;if(d.values.type===\"developer\"){type=\"Developer\";}else if((_d$values=d.values)===null||_d$values===void 0?void 0:_d$values.investor){type=\"Investor\";}else{type=\"Owner Occupier\";}return/*#__PURE__*/React.createElement(\"option\",{key:i,value:d._id},\"description: \",d.description,\" | type: \",type);})),meta.error&&meta.touched&&/*#__PURE__*/React.createElement(\"span\",{className:\"form-error f10\"},meta.error));}),/*#__PURE__*/React.createElement(\"div\",{className:\"form-buttons\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"form-button-p bs-3 font-white mt12 pt8 pb8\"},\"Save\")));}}));};var mapStateToProps=function mapStateToProps(state){return{isFetching:state.dashboards.isFetching,currentDashboard:state.dashboards.currentDashboard.values,savedDashboards:state.dashboards.savedDashboards,saveDashboardModal:state.navigation.modal.saveDashboard,user:state.user,requestSuceed:state.navigation.requestSuceed};};var mapDispatchToProps={setModal:setModal,saveDashboard:saveDashboard,updateDashboard:updateDashboard,setNotification:setNotification};export default connect(mapStateToProps,mapDispatchToProps)(SaveDashboardModal);","map":{"version":3,"sources":["/home/james/development/property-investor-dash/client/src/components/Dashboards/SaveDashboardModal.js"],"names":["React","useState","connect","useHistory","Form","Field","setModal","saveDashboard","updateDashboard","setNotification","composeValidators","required","maxLength","minLength","CONSTANTS","Button","Icon","SaveDashboardModal","isFetching","currentDashboard","savedDashboards","user","saveNew","setSaveNew","overwrite","setOverwrite","history","handleSave","saveData","data","username","MODALS","SAVEDASHBOARD","dashObject","values","description","push","handleOverwrite","console","log","handleCancel","e","CloseIcon","SaveIcon","OverwriteIcon","handleSubmit","form","input","meta","error","touched","map","d","i","type","investor","_id","mapStateToProps","state","dashboards","saveDashboardModal","navigation","modal","requestSuceed","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport { Form, Field } from \"react-final-form\";\nimport { setModal } from \"../../reducers/navigationReducer\";\nimport {\n  saveDashboard,\n  updateDashboard,\n} from \"../../reducers/dashboardReducer\";\nimport { setNotification } from \"../../reducers/notificationReducer\";\nimport {\n  composeValidators,\n  required,\n  maxLength,\n  minLength,\n} from \"../../utils/formValidatorHelper\";\nimport { CONSTANTS } from \"../../static/constants\";\nimport Button from \"../Shared/Button\";\nimport { Icon } from \"../Shared/Icon\";\nimport CloseIcon from \"../../styles/svg/close.svg\";\nimport SaveIcon from \"../../styles/svg/save.svg\";\nimport OverwriteIcon from \"../../styles/svg/overwrite.svg\";\n\nconst SaveDashboardModal = ({\n  isFetching,\n  currentDashboard,\n  savedDashboards,\n  user,\n  setModal,\n  setNotification,\n  saveDashboard,\n  updateDashboard,\n}) => {\n  const [saveNew, setSaveNew] = useState(true);\n  const [overwrite, setOverwrite] = useState(\"\");\n  const history = useHistory();\n\n  const handleSave = async (saveData) => {\n    if (!user.data.username) {\n      setModal(CONSTANTS.MODALS.SAVEDASHBOARD, false);\n      setNotification(\"Please login to save dashboard\", \"danger\");\n      return;\n    }\n\n    const dashObject = {\n      values: currentDashboard,\n      ...saveData,\n    };\n\n    await saveDashboard(dashObject);\n\n    setModal(CONSTANTS.MODALS.SAVEDASHBOARD, false);\n\n    if (!isFetching) {\n      setNotification(`${saveData.description} saved`, \"success\");\n      history.push(\"/saved-dashboards\");\n    }\n  };\n\n  const handleOverwrite = async (saveData) => {\n    // await updateDashboard(saveData);\n    console.log(\"overwrite \", overwrite);\n  };\n\n  const handleCancel = (e) => {\n    // React Final Form handles preventDefault()\n    setModal(CONSTANTS.MODALS.SAVEDASHBOARD, false);\n  };\n\n  return (\n    <div className=\"modal mt60 fixed r bs-3 bg-1 p20\">\n      <Button\n        ariaLabel={\"Close\"}\n        dataBalloonPos={\"left\"}\n        extraClass={\"modal-close-btn mt20 mr20 button-p align-c justify-c\"}\n        onClick={handleCancel}\n        iconUrl={CloseIcon}\n        iconColor={\"white\"}\n      />\n      <h2 className=\"f20 bold mb16\">Save Dashboard</h2>\n      <div className=\"flex-row\">\n        <button\n          type=\"submit\"\n          className={`save-opt button-transp-s rt pl16 pr16 flex-row align-c justify-c jump ${\n            saveNew ? \"active\" : \"\"\n          }`}\n          onClick={() => setSaveNew(true)}\n        >\n          <Icon\n            size={\"20px\"}\n            url={SaveIcon}\n            color={\"black\"}\n            hover={false}\n            active={false}\n          />\n          <span className=\"ml8 f16 bold\">Save New</span>\n        </button>\n        <button\n          type=\"submit\"\n          className={`save-opt button-transp-s rt pl16 pr16 flex-row align-c justify-c jump ${\n            saveNew ? \"\" : \"active\"\n          }`}\n          onClick={() => setSaveNew(false)}\n        >\n          <Icon\n            size={\"20px\"}\n            url={OverwriteIcon}\n            color={\"black\"}\n            hover={false}\n            active={false}\n          />\n          <span className=\"ml8 f16 bold\">Overwrite Existing</span>\n        </button>\n      </div>\n      {saveNew && (\n        <Form\n          onSubmit={handleSave}\n          render={({ handleSubmit, form }) => (\n            <form className=\"save-form mt20 mb20\" onSubmit={handleSubmit}>\n              <div className=\"flex-row align-c relative\">\n                <label htmlFor=\"save-description\" className=\"f16 mb8\">\n                  Description\n                  <span className=\"font-red f12 bold ml4\">*</span>\n                </label>\n              </div>\n              <Field\n                name=\"description\"\n                validate={composeValidators(\n                  required,\n                  minLength(3),\n                  maxLength(200)\n                )}\n              >\n                {({ input, meta }) => (\n                  <div className=\"relative mb20\">\n                    <input\n                      id=\"save-description\"\n                      className=\"form-input bs-1 w100\"\n                      placeholder=\"Description\"\n                      type=\"text\"\n                      {...input}\n                    />\n                    {meta.error && meta.touched && (\n                      <span className=\"form-error f10\">{meta.error}</span>\n                    )}\n                  </div>\n                )}\n              </Field>\n              <div className=\"flex-row align-c relative\">\n                <label htmlFor=\"save-description\" className=\"f16 mb8\">\n                  Address\n                  <span className=\"font-red f12 bold ml4\">*</span>\n                </label>\n              </div>\n              <Field\n                name=\"address\"\n                validate={composeValidators(\n                  required,\n                  minLength(3),\n                  maxLength(200)\n                )}\n              >\n                {({ input, meta }) => (\n                  <div className=\"relative mb20\">\n                    <input\n                      id=\"save-address\"\n                      className=\"form-input bs-1 w100\"\n                      placeholder=\"Address\"\n                      type=\"text\"\n                      {...input}\n                    />\n                    {meta.error && meta.touched && (\n                      <span className=\"form-error f10\">{meta.error}</span>\n                    )}\n                  </div>\n                )}\n              </Field>\n              <div className=\"form-buttons\">\n                <button\n                  type=\"submit\"\n                  className=\"form-button-p bs-3 font-white mt12 pt8 pb8\"\n                >\n                  Save As\n                </button>\n              </div>\n            </form>\n          )}\n        />\n      )}\n      {!saveNew && (\n        <Form\n          onSubmit={handleOverwrite}\n          render={({ handleSubmit, form, values }) => (\n            <form className=\"save-form mt20 mb20\" onSubmit={handleSubmit}>\n              <div className=\"flex-row align-c relative\">\n                <label htmlFor=\"save-overwrite\" className=\"f16 mb8\">\n                  Dashboard\n                  <span className=\"font-red f12 bold ml4\">*</span>\n                </label>\n              </div>\n              <Field name=\"dashboard\" validate={required}>\n                {({ input, meta }) => (\n                  <div className=\"relative mb20\">\n                    <select\n                      className=\"form-input select w100 bs-1\"\n                      id=\"save-overwrite\"\n                      name=\"dashboard\"\n                      onChange={() => setOverwrite(values)}\n                      multiple\n                    >\n                      {savedDashboards.map((d, i) => {\n                        let type;\n                        if (d.values.type === \"developer\") {\n                          type = \"Developer\";\n                        } else if (d.values?.investor) {\n                          type = \"Investor\";\n                        } else {\n                          type = \"Owner Occupier\";\n                        }\n                        return (\n                          <option key={i} value={d._id}>\n                            description: {d.description} | type: {type}\n                          </option>\n                        );\n                      })}\n                    </select>\n                    {meta.error && meta.touched && (\n                      <span className=\"form-error f10\">{meta.error}</span>\n                    )}\n                  </div>\n                )}\n              </Field>\n              <div className=\"form-buttons\">\n                <button\n                  type=\"submit\"\n                  className=\"form-button-p bs-3 font-white mt12 pt8 pb8\"\n                >\n                  Save\n                </button>\n              </div>\n            </form>\n          )}\n        />\n      )}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    isFetching: state.dashboards.isFetching,\n    currentDashboard: state.dashboards.currentDashboard.values,\n    savedDashboards: state.dashboards.savedDashboards,\n    saveDashboardModal: state.navigation.modal.saveDashboard,\n    user: state.user,\n    requestSuceed: state.navigation.requestSuceed,\n  };\n};\n\nconst mapDispatchToProps = {\n  setModal,\n  saveDashboard,\n  updateDashboard,\n  setNotification,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SaveDashboardModal);\n"]},"metadata":{},"sourceType":"module"}