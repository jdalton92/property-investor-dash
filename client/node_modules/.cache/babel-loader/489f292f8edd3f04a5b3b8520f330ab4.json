{"ast":null,"code":"import loginService from \"../services/login\";\nimport { setToken, destroyToken } from \"../helpers/tokenHelper\";\nimport userService from \"../services/user\";\nconst initialState = {\n  isFetching: true,\n  data: {}\n};\n\nconst userReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case \"USER_REQUEST\":\n      return { ...state,\n        isFetching: true\n      };\n\n    case \"USER_REQUEST_FAIL\":\n      return { ...state,\n        isFetching: false\n      };\n\n    case \"SET_USER\":\n      return {\n        isFetching: false,\n        data: action.data\n      };\n\n    case \"CLEAR_USER\":\n      return initialState;\n\n    default:\n      return state;\n  }\n};\n\nexport const initUser = () => {\n  return async dispatch => {\n    dispatch({\n      type: \"USER_REQUEST\"\n    });\n\n    try {\n      setTimeout(() => {\n        const loggedUserJSON = window.localStorage.getItem(\"loggedUser\");\n\n        if (loggedUserJSON) {\n          const user = JSON.parse(loggedUserJSON);\n          setToken(user.token);\n          dispatch({\n            type: \"SET_USER\",\n            data: user\n          });\n        } else {\n          dispatch({\n            type: \"USER_REQUEST_FAIL\"\n          });\n        }\n      }, 5000);\n    } catch (e) {\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"error\"\n        }\n      });\n    }\n  };\n};\nexport const createUser = ({\n  username,\n  email,\n  password,\n  checkPassword\n}) => {\n  return async dispatch => {\n    dispatch({\n      type: \"USER_REQUEST\"\n    });\n\n    try {\n      await userService.create({\n        username,\n        email,\n        password,\n        checkPassword\n      });\n      const user = await loginService.login({\n        email,\n        password\n      });\n      window.localStorage.setItem(\"loggedUser\", JSON.stringify(user));\n      setToken(user.token);\n      dispatch({\n        type: \"SET_USER\",\n        data: user\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: `${username} created`,\n          type: \"success\"\n        }\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\"\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"danger\"\n        }\n      });\n    }\n  };\n};\nexport const logoutUser = () => {\n  return async dispatch => {\n    destroyToken();\n    window.localStorage.removeItem(\"loggedUser\");\n    dispatch({\n      type: \"CLEAR_USER\"\n    });\n  };\n};\nexport const loginUser = (email, password) => {\n  return async dispatch => {\n    dispatch({\n      type: \"USER_REQUEST\"\n    });\n\n    try {\n      const user = await loginService.login({\n        email,\n        password\n      });\n      window.localStorage.setItem(\"loggedUser\", JSON.stringify(user));\n      setToken(user.token);\n      dispatch({\n        type: \"SET_USER\",\n        data: user\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\"\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: \"wrong username or password\",\n          type: \"error\"\n        }\n      });\n    }\n  };\n};\nexport const updateUser = (newEmail, oldPassword, newPassword, confirmNewPassword, id) => {\n  return async dispatch => {\n    dispatch({\n      type: \"USER_REQUEST\"\n    });\n\n    try {\n      const user = await userService.update(newEmail, oldPassword, newPassword, confirmNewPassword, id);\n      window.localStorage.setItem(\"loggedUser\", JSON.stringify(user));\n      destroyToken();\n      setToken(user.token);\n      dispatch({\n        type: \"SET_USER\",\n        data: user\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\"\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"error\"\n        }\n      });\n    }\n  };\n};\nexport const deleteUser = (password, id) => {\n  return async dispatch => {\n    dispatch({\n      type: \"USER_REQUEST\"\n    });\n\n    try {\n      await userService.deleteUser(password, id);\n      window.localStorage.removeItem(\"loggedUser\");\n      destroyToken();\n      dispatch({\n        type: \"CLEAR_USER\"\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\"\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"error\"\n        }\n      });\n    }\n  };\n};\nexport default userReducer;","map":{"version":3,"sources":["/home/james/development/property-investor-dash/client/src/reducers/userReducer.js"],"names":["loginService","setToken","destroyToken","userService","initialState","isFetching","data","userReducer","state","action","type","initUser","dispatch","setTimeout","loggedUserJSON","window","localStorage","getItem","user","JSON","parse","token","e","content","message","response","error","createUser","username","email","password","checkPassword","create","login","setItem","stringify","logoutUser","removeItem","loginUser","updateUser","newEmail","oldPassword","newPassword","confirmNewPassword","id","update","deleteUser"],"mappings":"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","sourcesContent":["import loginService from \"../services/login\";\nimport { setToken, destroyToken } from \"../helpers/tokenHelper\";\nimport userService from \"../services/user\";\n\nconst initialState = { isFetching: true, data: {} };\n\nconst userReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case \"USER_REQUEST\":\n      return { ...state, isFetching: true };\n    case \"USER_REQUEST_FAIL\":\n      return { ...state, isFetching: false };\n    case \"SET_USER\":\n      return {\n        isFetching: false,\n        data: action.data,\n      };\n    case \"CLEAR_USER\":\n      return initialState;\n    default:\n      return state;\n  }\n};\n\nexport const initUser = () => {\n  return async (dispatch) => {\n    dispatch({\n      type: \"USER_REQUEST\",\n    });\n    try {\n      setTimeout(() => {\n        const loggedUserJSON = window.localStorage.getItem(\"loggedUser\");\n\n        if (loggedUserJSON) {\n          const user = JSON.parse(loggedUserJSON);\n          setToken(user.token);\n\n          dispatch({\n            type: \"SET_USER\",\n            data: user,\n          });\n        } else {\n          dispatch({\n            type: \"USER_REQUEST_FAIL\",\n          });\n        }\n      }, 5000);\n    } catch (e) {\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"error\",\n        },\n      });\n    }\n  };\n};\n\nexport const createUser = ({ username, email, password, checkPassword }) => {\n  return async (dispatch) => {\n    dispatch({\n      type: \"USER_REQUEST\",\n    });\n    try {\n      await userService.create({\n        username,\n        email,\n        password,\n        checkPassword,\n      });\n\n      const user = await loginService.login({\n        email,\n        password,\n      });\n\n      window.localStorage.setItem(\"loggedUser\", JSON.stringify(user));\n\n      setToken(user.token);\n\n      dispatch({\n        type: \"SET_USER\",\n        data: user,\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: `${username} created`,\n          type: \"success\",\n        },\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\",\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"danger\",\n        },\n      });\n    }\n  };\n};\n\nexport const logoutUser = () => {\n  return async (dispatch) => {\n    destroyToken();\n    window.localStorage.removeItem(\"loggedUser\");\n    dispatch({\n      type: \"CLEAR_USER\",\n    });\n  };\n};\n\nexport const loginUser = (email, password) => {\n  return async (dispatch) => {\n    dispatch({\n      type: \"USER_REQUEST\",\n    });\n    try {\n      const user = await loginService.login({\n        email,\n        password,\n      });\n\n      window.localStorage.setItem(\"loggedUser\", JSON.stringify(user));\n      setToken(user.token);\n\n      dispatch({\n        type: \"SET_USER\",\n        data: user,\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\",\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: \"wrong username or password\",\n          type: \"error\",\n        },\n      });\n    }\n  };\n};\n\nexport const updateUser = (\n  newEmail,\n  oldPassword,\n  newPassword,\n  confirmNewPassword,\n  id\n) => {\n  return async (dispatch) => {\n    dispatch({\n      type: \"USER_REQUEST\",\n    });\n    try {\n      const user = await userService.update(\n        newEmail,\n        oldPassword,\n        newPassword,\n        confirmNewPassword,\n        id\n      );\n\n      window.localStorage.setItem(\"loggedUser\", JSON.stringify(user));\n      destroyToken();\n      setToken(user.token);\n\n      dispatch({\n        type: \"SET_USER\",\n        data: user,\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\",\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"error\",\n        },\n      });\n    }\n  };\n};\n\nexport const deleteUser = (password, id) => {\n  return async (dispatch) => {\n    dispatch({\n      type: \"USER_REQUEST\",\n    });\n    try {\n      await userService.deleteUser(password, id);\n\n      window.localStorage.removeItem(\"loggedUser\");\n      destroyToken();\n\n      dispatch({\n        type: \"CLEAR_USER\",\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\",\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"error\",\n        },\n      });\n    }\n  };\n};\n\nexport default userReducer;\n"]},"metadata":{},"sourceType":"module"}