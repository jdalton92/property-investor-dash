{"ast":null,"code":"import loginService from \"../services/login\";\nimport { setToken, destroyToken } from \"../helpers/tokenHelper\";\nimport userService from \"../services/user\";\nconst initialState = {\n  isFetching: false,\n  didInvalidate: false,\n  data: {}\n};\n\nconst userReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case \"USER_REQUEST\":\n      return { ...state,\n        isFetching: true,\n        didInvalidate: true\n      };\n\n    case \"USER_REQUEST_FAIL\":\n      return { ...state,\n        isFetching: false,\n        didInvalidate: true\n      };\n\n    case \"SET_USER\":\n      return {\n        isFetching: false,\n        didInvalidate: false,\n        data: action.data\n      };\n\n    case \"CLEAR_USER\":\n      return initialState;\n\n    default:\n      return state;\n  }\n};\n\nexport const initUser = () => {\n  return async dispatch => {\n    dispatch({\n      type: \"USER_REQUEST\"\n    });\n\n    try {\n      const loggedUserJSON = window.localStorage.getItem(\"loggedUser\");\n\n      if (loggedUserJSON) {\n        const user = JSON.parse(loggedUserJSON);\n        setToken(user.token);\n        dispatch({\n          type: \"SET_USER\",\n          data: user\n        });\n      }\n    } catch (e) {\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"error\"\n        }\n      });\n    }\n  };\n};\nexport const createUser = ({\n  username,\n  email,\n  password,\n  checkPassword\n}) => {\n  return async dispatch => {\n    dispatch({\n      type: \"USER_REQUEST\"\n    });\n\n    try {\n      await userService.create({\n        username,\n        email,\n        password,\n        checkPassword\n      });\n      const user = await loginService.login({\n        email,\n        password\n      });\n      window.localStorage.setItem(\"loggedUser\", JSON.stringify(user));\n      setToken(user.token);\n      dispatch({\n        type: \"SET_USER\",\n        data: user\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: `${username} created`,\n          type: \"success\"\n        }\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\"\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"danger\"\n        }\n      });\n    }\n  };\n};\nexport const logoutUser = () => {\n  return async dispatch => {\n    destroyToken();\n    window.localStorage.removeItem(\"loggedUser\");\n    dispatch({\n      type: \"CLEAR_USER\"\n    });\n  };\n};\nexport const loginUser = (email, password) => {\n  return async dispatch => {\n    dispatch({\n      type: \"USER_REQUEST\"\n    });\n\n    try {\n      const user = await loginService.login({\n        email,\n        password\n      });\n      window.localStorage.setItem(\"loggedUser\", JSON.stringify(user));\n      setToken(user.token);\n      dispatch({\n        type: \"SET_USER\",\n        data: user\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\"\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: \"wrong username or password\",\n          type: \"error\"\n        }\n      });\n    }\n  };\n};\nexport const updateUser = (newEmail, oldPassword, newPassword, confirmNewPassword, id) => {\n  return async dispatch => {\n    dispatch({\n      type: \"USER_REQUEST\"\n    });\n\n    try {\n      const user = await userService.update(newEmail, oldPassword, newPassword, confirmNewPassword, id);\n      window.localStorage.setItem(\"loggedUser\", JSON.stringify(user));\n      destroyToken();\n      setToken(user.token);\n      dispatch({\n        type: \"SET_USER\",\n        data: user\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\"\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"error\"\n        }\n      });\n    }\n  };\n};\nexport const deleteUser = (password, id) => {\n  return async dispatch => {\n    dispatch({\n      type: \"USER_REQUEST\"\n    });\n\n    try {\n      await userService.deleteUser(password, id);\n      window.localStorage.removeItem(\"loggedUser\");\n      destroyToken();\n      dispatch({\n        type: \"CLEAR_USER\"\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\"\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"error\"\n        }\n      });\n    }\n  };\n};\nexport default userReducer;","map":{"version":3,"sources":["/home/james/development/property-investor-dash/client/src/reducers/userReducer.js"],"names":["loginService","setToken","destroyToken","userService","initialState","isFetching","didInvalidate","data","userReducer","state","action","type","initUser","dispatch","loggedUserJSON","window","localStorage","getItem","user","JSON","parse","token","e","content","message","response","error","createUser","username","email","password","checkPassword","create","login","setItem","stringify","logoutUser","removeItem","loginUser","updateUser","newEmail","oldPassword","newPassword","confirmNewPassword","id","update","deleteUser"],"mappings":"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","sourcesContent":["import loginService from \"../services/login\";\nimport { setToken, destroyToken } from \"../helpers/tokenHelper\";\nimport userService from \"../services/user\";\n\nconst initialState = { isFetching: false, didInvalidate: false, data: {} };\n\nconst userReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case \"USER_REQUEST\":\n      return { ...state, isFetching: true, didInvalidate: true };\n    case \"USER_REQUEST_FAIL\":\n      return { ...state, isFetching: false, didInvalidate: true };\n    case \"SET_USER\":\n      return {\n        isFetching: false,\n        didInvalidate: false,\n        data: action.data,\n      };\n    case \"CLEAR_USER\":\n      return initialState;\n    default:\n      return state;\n  }\n};\n\nexport const initUser = () => {\n  return async (dispatch) => {\n    dispatch({\n      type: \"USER_REQUEST\",\n    });\n    try {\n      const loggedUserJSON = window.localStorage.getItem(\"loggedUser\");\n\n      if (loggedUserJSON) {\n        const user = JSON.parse(loggedUserJSON);\n        setToken(user.token);\n\n        dispatch({\n          type: \"SET_USER\",\n          data: user,\n        });\n      }\n    } catch (e) {\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"error\",\n        },\n      });\n    }\n  };\n};\n\nexport const createUser = ({ username, email, password, checkPassword }) => {\n  return async (dispatch) => {\n    dispatch({\n      type: \"USER_REQUEST\",\n    });\n    try {\n      await userService.create({\n        username,\n        email,\n        password,\n        checkPassword,\n      });\n\n      const user = await loginService.login({\n        email,\n        password,\n      });\n\n      window.localStorage.setItem(\"loggedUser\", JSON.stringify(user));\n\n      setToken(user.token);\n\n      dispatch({\n        type: \"SET_USER\",\n        data: user,\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: `${username} created`,\n          type: \"success\",\n        },\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\",\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"danger\",\n        },\n      });\n    }\n  };\n};\n\nexport const logoutUser = () => {\n  return async (dispatch) => {\n    destroyToken();\n    window.localStorage.removeItem(\"loggedUser\");\n    dispatch({\n      type: \"CLEAR_USER\",\n    });\n  };\n};\n\nexport const loginUser = (email, password) => {\n  return async (dispatch) => {\n    dispatch({\n      type: \"USER_REQUEST\",\n    });\n    try {\n      const user = await loginService.login({\n        email,\n        password,\n      });\n\n      window.localStorage.setItem(\"loggedUser\", JSON.stringify(user));\n      setToken(user.token);\n\n      dispatch({\n        type: \"SET_USER\",\n        data: user,\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\",\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: \"wrong username or password\",\n          type: \"error\",\n        },\n      });\n    }\n  };\n};\n\nexport const updateUser = (\n  newEmail,\n  oldPassword,\n  newPassword,\n  confirmNewPassword,\n  id\n) => {\n  return async (dispatch) => {\n    dispatch({\n      type: \"USER_REQUEST\",\n    });\n    try {\n      const user = await userService.update(\n        newEmail,\n        oldPassword,\n        newPassword,\n        confirmNewPassword,\n        id\n      );\n\n      window.localStorage.setItem(\"loggedUser\", JSON.stringify(user));\n      destroyToken();\n      setToken(user.token);\n\n      dispatch({\n        type: \"SET_USER\",\n        data: user,\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\",\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"error\",\n        },\n      });\n    }\n  };\n};\n\nexport const deleteUser = (password, id) => {\n  return async (dispatch) => {\n    dispatch({\n      type: \"USER_REQUEST\",\n    });\n    try {\n      await userService.deleteUser(password, id);\n\n      window.localStorage.removeItem(\"loggedUser\");\n      destroyToken();\n\n      dispatch({\n        type: \"CLEAR_USER\",\n      });\n    } catch (e) {\n      dispatch({\n        type: \"USER_REQUEST_FAIL\",\n      });\n      dispatch({\n        type: \"SET_NOTIFICATION\",\n        content: {\n          message: e.response.data.error,\n          type: \"error\",\n        },\n      });\n    }\n  };\n};\n\nexport default userReducer;\n"]},"metadata":{},"sourceType":"module"}