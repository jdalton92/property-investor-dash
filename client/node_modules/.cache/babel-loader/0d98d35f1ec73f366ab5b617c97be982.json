{"ast":null,"code":"import _regeneratorRuntime from\"/home/james/development/property-investor-dash/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _objectSpread from\"/home/james/development/property-investor-dash/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/james/development/property-investor-dash/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/james/development/property-investor-dash/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from\"react\";import{connect}from\"react-redux\";import{Form,Field}from\"react-final-form\";import{setModal,setTab}from\"../../reducers/navigationReducer\";import{saveDashboard,updateDashboard}from\"../../reducers/dashboardReducer\";import{composeValidators,required,maxLength,minLength}from\"../../utils/formValidatorHelper\";import{formatDate}from\"../../utils/dashboardHelper\";import{CONSTANTS}from\"../../static/constants\";import Button from\"../Shared/Button\";import{Icon}from\"../Shared/Icon\";import Loader from\"../Shared/Loader\";import CloseIcon from\"../../styles/svg/close.svg\";import SaveIcon from\"../../styles/svg/save.svg\";import OverwriteIcon from\"../../styles/svg/overwrite.svg\";var SaveDashboardModal=function SaveDashboardModal(_ref){var isFetching=_ref.isFetching,currentDashboard=_ref.currentDashboard,savedDashboards=_ref.savedDashboards,setModal=_ref.setModal,saveDashboard=_ref.saveDashboard,updateDashboard=_ref.updateDashboard,setTab=_ref.setTab,tab=_ref.tab;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),selectedDashboard=_useState2[0],setSelectedDashboard=_useState2[1];var handleSave=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(saveData){var dashObject;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:dashObject=_objectSpread({values:currentDashboard.values},saveData);_context.next=3;return saveDashboard(dashObject);case 3:setModal(CONSTANTS.MODALS.SAVEDASHBOARD,false);case 4:case\"end\":return _context.stop();}}},_callee);}));return function handleSave(_x){return _ref2.apply(this,arguments);};}();var handleOverwrite=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(values){var dashboard;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// Original saved data\ndashboard=savedDashboards.filter(function(d){return d._id===selectedDashboard;});// New data\ndashboard.address=values.address;dashboard.description=values.description;dashboard.values=currentDashboard.values;_context2.next=6;return updateDashboard(dashboard);case 6:setModal(CONSTANTS.MODALS.SAVEDASHBOARD,false);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function handleOverwrite(_x2){return _ref3.apply(this,arguments);};}();var handleCancel=function handleCancel(){// React Final Form handles preventDefault()\nsetModal(CONSTANTS.MODALS.SAVEDASHBOARD,false);};return/*#__PURE__*/React.createElement(\"div\",{className:\"modal fixed r bs-3 bg-1 p20\"},/*#__PURE__*/React.createElement(Button,{ariaLabel:\"Close\",dataBalloonPos:\"left\",extraClass:\"modal-close-btn mt20 mr20 button-p align-c justify-c\",onClick:handleCancel,iconUrl:CloseIcon,iconColor:\"white\"}),/*#__PURE__*/React.createElement(\"h2\",{className:\"f20 bold mb16\"},\"Save Dashboard\"),/*#__PURE__*/React.createElement(\"div\",{className:\"flex-row\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"save-opt button-transp-s rt pl16 pr16 flex-row align-c justify-c jump \".concat(tab===CONSTANTS.TABS.SAVEDASHBOARD.SAVE?\"active\":\"\"),onClick:function onClick(){return setTab(\"saveDashboard\",CONSTANTS.TABS.SAVEDASHBOARD.SAVE);}},/*#__PURE__*/React.createElement(Icon,{size:\"20px\",url:SaveIcon,color:\"black\",hover:false,active:false}),/*#__PURE__*/React.createElement(\"span\",{className:\"ml8 f16 bold\"},\"Save New\")),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",className:\"save-opt button-transp-s rt pl16 pr16 flex-row align-c justify-c jump \".concat(tab===CONSTANTS.TABS.SAVEDASHBOARD.OVERWRITE?\"active\":\"\"),onClick:function onClick(){return setTab(\"saveDashboard\",CONSTANTS.TABS.SAVEDASHBOARD.OVERWRITE);}},/*#__PURE__*/React.createElement(Icon,{size:\"20px\",url:OverwriteIcon,color:\"black\",hover:false,active:false}),/*#__PURE__*/React.createElement(\"span\",{className:\"ml8 f16 bold\"},\"Overwrite Existing\"))),isFetching&&/*#__PURE__*/React.createElement(Loader,null),!isFetching&&tab===CONSTANTS.TABS.SAVEDASHBOARD.SAVE&&/*#__PURE__*/React.createElement(Form,{onSubmit:handleSave,render:function render(_ref4){var handleSubmit=_ref4.handleSubmit,form=_ref4.form;return/*#__PURE__*/React.createElement(\"form\",{className:\"save-form mt20 mb20\",onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"flex-row align-c relative\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"save-description\",className:\"f16 mb8\"},\"Description\",/*#__PURE__*/React.createElement(\"span\",{className:\"font-red f12 bold ml4\"},\"*\"))),/*#__PURE__*/React.createElement(Field,{name:\"description\",validate:composeValidators(required,minLength(3),maxLength(200))},function(_ref5){var input=_ref5.input,meta=_ref5.meta;return/*#__PURE__*/React.createElement(\"div\",{className:\"relative mb20\"},/*#__PURE__*/React.createElement(\"input\",Object.assign({id:\"save-description\",className:\"form-input bs-1 w100\",placeholder:\"Description\",type:\"text\"},input)),meta.error&&meta.touched&&/*#__PURE__*/React.createElement(\"span\",{className:\"form-error f10\"},meta.error));}),/*#__PURE__*/React.createElement(\"div\",{className:\"flex-row align-c relative\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"save-description\",className:\"f16 mb8\"},\"Address\",/*#__PURE__*/React.createElement(\"span\",{className:\"font-red f12 bold ml4\"},\"*\"))),/*#__PURE__*/React.createElement(Field,{name:\"address\",validate:composeValidators(required,minLength(3),maxLength(200))},function(_ref6){var input=_ref6.input,meta=_ref6.meta;return/*#__PURE__*/React.createElement(\"div\",{className:\"relative mb20\"},/*#__PURE__*/React.createElement(\"input\",Object.assign({id:\"save-address\",className:\"form-input bs-1 w100\",placeholder:\"Address\",type:\"text\"},input)),meta.error&&meta.touched&&/*#__PURE__*/React.createElement(\"span\",{className:\"form-error f10\"},meta.error));}),/*#__PURE__*/React.createElement(\"div\",{className:\"form-buttons\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"form-button-p bs-3 font-white mt12 pt8 pb8\"},\"Save As\")));}}),!isFetching&&tab===CONSTANTS.TABS.SAVEDASHBOARD.OVERWRITE&&savedDashboards.length===0&&/*#__PURE__*/React.createElement(\"div\",{className:\"mt20 f16\"},\"No saved dashboards...\"),!isFetching&&tab===CONSTANTS.TABS.SAVEDASHBOARD.OVERWRITE&&savedDashboards.length>0&&/*#__PURE__*/React.createElement(Form,{onSubmit:handleOverwrite,validate:function validate(values){var errors={};if(!selectedDashboard){errors.dashboard=\"Required\";}return errors;},render:function render(_ref7){var handleSubmit=_ref7.handleSubmit,form=_ref7.form,values=_ref7.values;return/*#__PURE__*/React.createElement(\"form\",{className:\"save-form mt20 mb20\",onSubmit:handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"flex-row align-c relative\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"overwrite-dashboard\",className:\"f16 mb8\"},\"Dashboard\",/*#__PURE__*/React.createElement(\"span\",{className:\"font-red f12 bold ml4\"},\"*\"))),/*#__PURE__*/React.createElement(Field,{name:\"dashboard\"},function(_ref8){var input=_ref8.input,meta=_ref8.meta;return/*#__PURE__*/React.createElement(\"div\",{className:\"relative mb20\"},/*#__PURE__*/React.createElement(\"div\",{className:\"mh300 o-y-auto\"},/*#__PURE__*/React.createElement(\"table\",{id:\"overwrite-dashboard\",className:\"overpayments w100\"},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",{className:\"h768\"},\"Ref\"),/*#__PURE__*/React.createElement(\"th\",null,\"Description\"),/*#__PURE__*/React.createElement(\"th\",{className:\"h768\"},\"Type\"),/*#__PURE__*/React.createElement(\"th\",null,\"Created\"),/*#__PURE__*/React.createElement(\"th\",null,\"Overwrite\"))),/*#__PURE__*/React.createElement(\"tbody\",null,savedDashboards.map(function(d,i){var _d$values,_d$values2;var type;if(((_d$values=d.values)===null||_d$values===void 0?void 0:_d$values.type)===\"developer\"){type=\"Developer\";}else if((_d$values2=d.values)===null||_d$values2===void 0?void 0:_d$values2.investor){type=\"Investor\";}else{type=\"Owner Occupier\";}return/*#__PURE__*/React.createElement(\"tr\",{key:i,onClick:function onClick(){return selectedDashboard===d._id?setSelectedDashboard(null):setSelectedDashboard(d._id);},className:\"\".concat(d._id===selectedDashboard?\"selected\":\"\")},/*#__PURE__*/React.createElement(\"td\",{className:\"h768\"},i+1),/*#__PURE__*/React.createElement(\"td\",null,d.description),/*#__PURE__*/React.createElement(\"td\",{className:\"h768\"},type),/*#__PURE__*/React.createElement(\"td\",null,formatDate(d.date)),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"input\",{className:\"ml16\",type:\"checkbox\",checked:d._id===selectedDashboard,value:d._id,onChange:function onChange(){return selectedDashboard===d._id?setSelectedDashboard(null):setSelectedDashboard(d._id);}})));})))),meta.error&&meta.touched&&/*#__PURE__*/React.createElement(\"span\",{className:\"form-error f10\"},meta.error));}),/*#__PURE__*/React.createElement(\"div\",{className:\"flex-row align-c relative\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"overwrite-description\",className:\"f16 mb8\"},\"Description\",/*#__PURE__*/React.createElement(\"span\",{className:\"font-red f12 bold ml4\"},\"*\"))),/*#__PURE__*/React.createElement(Field,{name:\"description\",validate:composeValidators(required,minLength(3),maxLength(200))},function(_ref9){var input=_ref9.input,meta=_ref9.meta;return/*#__PURE__*/React.createElement(\"div\",{className:\"relative mb20\"},/*#__PURE__*/React.createElement(\"input\",Object.assign({id:\"overwrite-description\",className:\"form-input bs-1 w100\",placeholder:\"Description\",type:\"text\"},input)),meta.error&&meta.touched&&/*#__PURE__*/React.createElement(\"span\",{className:\"form-error f10\"},meta.error));}),/*#__PURE__*/React.createElement(\"div\",{className:\"flex-row align-c relative\"},/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"overwrite-description\",className:\"f16 mb8\"},\"Address\",/*#__PURE__*/React.createElement(\"span\",{className:\"font-red f12 bold ml4\"},\"*\"))),/*#__PURE__*/React.createElement(Field,{name:\"address\",validate:composeValidators(required,minLength(3),maxLength(200))},function(_ref10){var input=_ref10.input,meta=_ref10.meta;return/*#__PURE__*/React.createElement(\"div\",{className:\"relative mb20\"},/*#__PURE__*/React.createElement(\"input\",Object.assign({id:\"overwrite-address\",className:\"form-input bs-1 w100\",placeholder:\"Address\",type:\"text\"},input)),meta.error&&meta.touched&&/*#__PURE__*/React.createElement(\"span\",{className:\"form-error f10\"},meta.error));}),/*#__PURE__*/React.createElement(\"div\",{className:\"form-buttons\"},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",className:\"form-button-p bs-3 font-white mt12 pt8 pb8\"},\"Save\")));}}));};var mapStateToProps=function mapStateToProps(state){return{isFetching:state.dashboards.isFetching,currentDashboard:state.dashboards.currentDashboard.data,savedDashboards:state.dashboards.savedDashboards,saveDashboardModal:state.navigation.modal.saveDashboard,tab:state.navigation.tabs.saveDashboard};};var mapDispatchToProps={setModal:setModal,setTab:setTab,saveDashboard:saveDashboard,updateDashboard:updateDashboard};export default connect(mapStateToProps,mapDispatchToProps)(SaveDashboardModal);","map":{"version":3,"sources":["/home/james/development/property-investor-dash/client/src/components/Dashboards/SaveDashboardModal.js"],"names":["React","useState","connect","Form","Field","setModal","setTab","saveDashboard","updateDashboard","composeValidators","required","maxLength","minLength","formatDate","CONSTANTS","Button","Icon","Loader","SaveDashboardModal","isFetching","currentDashboard","savedDashboards","tab","selectedDashboard","setSelectedDashboard","handleSave","saveData","dashObject","values","MODALS","SAVEDASHBOARD","handleOverwrite","dashboard","filter","d","_id","address","description","handleCancel","CloseIcon","TABS","SAVE","SaveIcon","OVERWRITE","OverwriteIcon","handleSubmit","form","input","meta","error","touched","length","errors","map","i","type","investor","date","mapStateToProps","state","dashboards","data","saveDashboardModal","navigation","modal","tabs","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Form, Field } from \"react-final-form\";\nimport { setModal, setTab } from \"../../reducers/navigationReducer\";\nimport {\n  saveDashboard,\n  updateDashboard,\n} from \"../../reducers/dashboardReducer\";\nimport {\n  composeValidators,\n  required,\n  maxLength,\n  minLength,\n} from \"../../utils/formValidatorHelper\";\nimport { formatDate } from \"../../utils/dashboardHelper\";\nimport { CONSTANTS } from \"../../static/constants\";\nimport Button from \"../Shared/Button\";\nimport { Icon } from \"../Shared/Icon\";\nimport Loader from \"../Shared/Loader\";\nimport CloseIcon from \"../../styles/svg/close.svg\";\nimport SaveIcon from \"../../styles/svg/save.svg\";\nimport OverwriteIcon from \"../../styles/svg/overwrite.svg\";\n\nconst SaveDashboardModal = ({\n  isFetching,\n  currentDashboard,\n  savedDashboards,\n  setModal,\n  saveDashboard,\n  updateDashboard,\n  setTab,\n  tab,\n}) => {\n  const [selectedDashboard, setSelectedDashboard] = useState(null);\n\n  const handleSave = async (saveData) => {\n    const dashObject = {\n      values: currentDashboard.values,\n      ...saveData,\n    };\n    await saveDashboard(dashObject);\n    setModal(CONSTANTS.MODALS.SAVEDASHBOARD, false);\n  };\n\n  const handleOverwrite = async (values) => {\n    // Original saved data\n    const dashboard = savedDashboards.filter(\n      (d) => d._id === selectedDashboard\n    );\n    // New data\n    dashboard.address = values.address;\n    dashboard.description = values.description;\n    dashboard.values = currentDashboard.values;\n    await updateDashboard(dashboard);\n    setModal(CONSTANTS.MODALS.SAVEDASHBOARD, false);\n  };\n\n  const handleCancel = () => {\n    // React Final Form handles preventDefault()\n    setModal(CONSTANTS.MODALS.SAVEDASHBOARD, false);\n  };\n\n  return (\n    <div className=\"modal fixed r bs-3 bg-1 p20\">\n      <Button\n        ariaLabel={\"Close\"}\n        dataBalloonPos={\"left\"}\n        extraClass={\"modal-close-btn mt20 mr20 button-p align-c justify-c\"}\n        onClick={handleCancel}\n        iconUrl={CloseIcon}\n        iconColor={\"white\"}\n      />\n      <h2 className=\"f20 bold mb16\">Save Dashboard</h2>\n      <div className=\"flex-row\">\n        <button\n          type=\"button\"\n          className={`save-opt button-transp-s rt pl16 pr16 flex-row align-c justify-c jump ${\n            tab === CONSTANTS.TABS.SAVEDASHBOARD.SAVE ? \"active\" : \"\"\n          }`}\n          onClick={() =>\n            setTab(\"saveDashboard\", CONSTANTS.TABS.SAVEDASHBOARD.SAVE)\n          }\n        >\n          <Icon\n            size={\"20px\"}\n            url={SaveIcon}\n            color={\"black\"}\n            hover={false}\n            active={false}\n          />\n          <span className=\"ml8 f16 bold\">Save New</span>\n        </button>\n        <button\n          type=\"button\"\n          className={`save-opt button-transp-s rt pl16 pr16 flex-row align-c justify-c jump ${\n            tab === CONSTANTS.TABS.SAVEDASHBOARD.OVERWRITE ? \"active\" : \"\"\n          }`}\n          onClick={() =>\n            setTab(\"saveDashboard\", CONSTANTS.TABS.SAVEDASHBOARD.OVERWRITE)\n          }\n        >\n          <Icon\n            size={\"20px\"}\n            url={OverwriteIcon}\n            color={\"black\"}\n            hover={false}\n            active={false}\n          />\n          <span className=\"ml8 f16 bold\">Overwrite Existing</span>\n        </button>\n      </div>\n      {isFetching && <Loader />}\n      {!isFetching && tab === CONSTANTS.TABS.SAVEDASHBOARD.SAVE && (\n        <Form\n          onSubmit={handleSave}\n          render={({ handleSubmit, form }) => (\n            <form className=\"save-form mt20 mb20\" onSubmit={handleSubmit}>\n              <div className=\"flex-row align-c relative\">\n                <label htmlFor=\"save-description\" className=\"f16 mb8\">\n                  Description\n                  <span className=\"font-red f12 bold ml4\">*</span>\n                </label>\n              </div>\n              <Field\n                name=\"description\"\n                validate={composeValidators(\n                  required,\n                  minLength(3),\n                  maxLength(200)\n                )}\n              >\n                {({ input, meta }) => (\n                  <div className=\"relative mb20\">\n                    <input\n                      id=\"save-description\"\n                      className=\"form-input bs-1 w100\"\n                      placeholder=\"Description\"\n                      type=\"text\"\n                      {...input}\n                    />\n                    {meta.error && meta.touched && (\n                      <span className=\"form-error f10\">{meta.error}</span>\n                    )}\n                  </div>\n                )}\n              </Field>\n              <div className=\"flex-row align-c relative\">\n                <label htmlFor=\"save-description\" className=\"f16 mb8\">\n                  Address\n                  <span className=\"font-red f12 bold ml4\">*</span>\n                </label>\n              </div>\n              <Field\n                name=\"address\"\n                validate={composeValidators(\n                  required,\n                  minLength(3),\n                  maxLength(200)\n                )}\n              >\n                {({ input, meta }) => (\n                  <div className=\"relative mb20\">\n                    <input\n                      id=\"save-address\"\n                      className=\"form-input bs-1 w100\"\n                      placeholder=\"Address\"\n                      type=\"text\"\n                      {...input}\n                    />\n                    {meta.error && meta.touched && (\n                      <span className=\"form-error f10\">{meta.error}</span>\n                    )}\n                  </div>\n                )}\n              </Field>\n              <div className=\"form-buttons\">\n                <button\n                  type=\"submit\"\n                  className=\"form-button-p bs-3 font-white mt12 pt8 pb8\"\n                >\n                  Save As\n                </button>\n              </div>\n            </form>\n          )}\n        />\n      )}\n      {!isFetching &&\n        tab === CONSTANTS.TABS.SAVEDASHBOARD.OVERWRITE &&\n        savedDashboards.length === 0 && (\n          <div className=\"mt20 f16\">No saved dashboards...</div>\n        )}\n      {!isFetching &&\n        tab === CONSTANTS.TABS.SAVEDASHBOARD.OVERWRITE &&\n        savedDashboards.length > 0 && (\n          <Form\n            onSubmit={handleOverwrite}\n            validate={(values) => {\n              const errors = {};\n              if (!selectedDashboard) {\n                errors.dashboard = \"Required\";\n              }\n              return errors;\n            }}\n            render={({ handleSubmit, form, values }) => (\n              <form className=\"save-form mt20 mb20\" onSubmit={handleSubmit}>\n                <div className=\"flex-row align-c relative\">\n                  <label htmlFor=\"overwrite-dashboard\" className=\"f16 mb8\">\n                    Dashboard\n                    <span className=\"font-red f12 bold ml4\">*</span>\n                  </label>\n                </div>\n                <Field name=\"dashboard\">\n                  {({ input, meta }) => (\n                    <div className=\"relative mb20\">\n                      <div className=\"mh300 o-y-auto\">\n                        <table\n                          id=\"overwrite-dashboard\"\n                          className=\"overpayments w100\"\n                        >\n                          <thead>\n                            <tr>\n                              <th className=\"h768\">Ref</th>\n                              <th>Description</th>\n                              <th className=\"h768\">Type</th>\n                              <th>Created</th>\n                              <th>Overwrite</th>\n                            </tr>\n                          </thead>\n                          <tbody>\n                            {savedDashboards.map((d, i) => {\n                              let type;\n                              if (d.values?.type === \"developer\") {\n                                type = \"Developer\";\n                              } else if (d.values?.investor) {\n                                type = \"Investor\";\n                              } else {\n                                type = \"Owner Occupier\";\n                              }\n                              return (\n                                <tr\n                                  key={i}\n                                  onClick={() =>\n                                    selectedDashboard === d._id\n                                      ? setSelectedDashboard(null)\n                                      : setSelectedDashboard(d._id)\n                                  }\n                                  className={`${\n                                    d._id === selectedDashboard\n                                      ? \"selected\"\n                                      : \"\"\n                                  }`}\n                                >\n                                  <td className=\"h768\">{i + 1}</td>\n                                  <td>{d.description}</td>\n                                  <td className=\"h768\">{type}</td>\n                                  <td>{formatDate(d.date)}</td>\n                                  <td>\n                                    <input\n                                      className=\"ml16\"\n                                      type=\"checkbox\"\n                                      checked={d._id === selectedDashboard}\n                                      value={d._id}\n                                      onChange={() =>\n                                        selectedDashboard === d._id\n                                          ? setSelectedDashboard(null)\n                                          : setSelectedDashboard(d._id)\n                                      }\n                                    />\n                                  </td>\n                                </tr>\n                              );\n                            })}\n                          </tbody>\n                        </table>\n                      </div>\n                      {meta.error && meta.touched && (\n                        <span className=\"form-error f10\">{meta.error}</span>\n                      )}\n                    </div>\n                  )}\n                </Field>\n                <div className=\"flex-row align-c relative\">\n                  <label htmlFor=\"overwrite-description\" className=\"f16 mb8\">\n                    Description\n                    <span className=\"font-red f12 bold ml4\">*</span>\n                  </label>\n                </div>\n                <Field\n                  name=\"description\"\n                  validate={composeValidators(\n                    required,\n                    minLength(3),\n                    maxLength(200)\n                  )}\n                >\n                  {({ input, meta }) => (\n                    <div className=\"relative mb20\">\n                      <input\n                        id=\"overwrite-description\"\n                        className=\"form-input bs-1 w100\"\n                        placeholder=\"Description\"\n                        type=\"text\"\n                        {...input}\n                      />\n                      {meta.error && meta.touched && (\n                        <span className=\"form-error f10\">{meta.error}</span>\n                      )}\n                    </div>\n                  )}\n                </Field>\n                <div className=\"flex-row align-c relative\">\n                  <label htmlFor=\"overwrite-description\" className=\"f16 mb8\">\n                    Address\n                    <span className=\"font-red f12 bold ml4\">*</span>\n                  </label>\n                </div>\n                <Field\n                  name=\"address\"\n                  validate={composeValidators(\n                    required,\n                    minLength(3),\n                    maxLength(200)\n                  )}\n                >\n                  {({ input, meta }) => (\n                    <div className=\"relative mb20\">\n                      <input\n                        id=\"overwrite-address\"\n                        className=\"form-input bs-1 w100\"\n                        placeholder=\"Address\"\n                        type=\"text\"\n                        {...input}\n                      />\n                      {meta.error && meta.touched && (\n                        <span className=\"form-error f10\">{meta.error}</span>\n                      )}\n                    </div>\n                  )}\n                </Field>\n                <div className=\"form-buttons\">\n                  <button\n                    type=\"submit\"\n                    className=\"form-button-p bs-3 font-white mt12 pt8 pb8\"\n                  >\n                    Save\n                  </button>\n                </div>\n              </form>\n            )}\n          />\n        )}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    isFetching: state.dashboards.isFetching,\n    currentDashboard: state.dashboards.currentDashboard.data,\n    savedDashboards: state.dashboards.savedDashboards,\n    saveDashboardModal: state.navigation.modal.saveDashboard,\n    tab: state.navigation.tabs.saveDashboard,\n  };\n};\n\nconst mapDispatchToProps = {\n  setModal,\n  setTab,\n  saveDashboard,\n  updateDashboard,\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SaveDashboardModal);\n"]},"metadata":{},"sourceType":"module"}